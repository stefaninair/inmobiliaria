@model Inmobiliaria.Models.Contrato

@{
    ViewData["Title"] = "Renovar Contrato";
}

<h1>Renovar Contrato</h1>

<h3>¿Estás seguro que deseas renovar este contrato?</h3>
<hr />

<div class="row">
    <div class="col-md-8">
        <table class="table table-bordered">
            <tr>
                <th>ID</th>
                <td>@Model.Id</td>
            </tr>
            <tr>
                <th>Inmueble</th>
                <td>@Model.Inmueble?.Direccion</td>
            </tr>
            <tr>
                <th>Inquilino</th>
                <td>@Model.Inquilino?.Nombre @Model.Inquilino?.Apellido</td>
            </tr>
            <tr>
                <th>Fecha de Inicio</th>
                <td>@Model.FechaInicio.ToShortDateString()</td>
            </tr>
            <tr>
                <th>Fecha de Fin Actual</th>
                <td>@Model.FechaFin.ToShortDateString()</td>
            </tr>
            <tr>
                <th>Monto Mensual Actual</th>
                <td>@Model.MontoMensual.ToString("C")</td>
            </tr>
        </table>

        <form asp-action="Renovar" method="post">
            <input type="hidden" asp-for="Id" />
            
            <div class="form-group">
                <label for="nuevaFechaFin" class="form-label">Nueva Fecha de Fin:</label>
                <input type="date" name="nuevaFechaFin" id="nuevaFechaFin" class="form-control" required />
                <small class="form-text text-muted">Debe ser posterior a la fecha de fin actual (@Model.FechaFin.ToShortDateString())</small>
            </div>

            <div class="form-group">
                <label for="nuevoMontoMensual" class="form-label">Nuevo Monto Mensual (opcional):</label>
                <input type="number" name="nuevoMontoMensual" id="nuevoMontoMensual" class="form-control" step="0.01" min="0" />
                <small class="form-text text-muted">Dejar vacío para mantener el monto actual (@Model.MontoMensual.ToString("C"))</small>
            </div>

            <div class="alert alert-info">
                <i class="fa-solid fa-info-circle"></i>
                <strong>Información:</strong> La renovación extenderá la fecha de fin del contrato. 
                El contrato seguirá vigente hasta la nueva fecha especificada.
            </div>

            <div class="form-group">
                <button type="submit" class="btn btn-success">
                    <i class="fa-solid fa-calendar-plus"></i> Confirmar Renovación
                </button>
                <a class="btn btn-secondary" asp-action="Index">
                    <i class="fa-solid fa-arrow-left"></i> Cancelar
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        // Establecer fecha mínima
        document.getElementById('nuevaFechaFin').min = '@Model.FechaFin.ToString("yyyy-MM-dd")';
        
        // Establecer fecha por defecto (30 días después de la fecha de fin actual)
        var fechaFin = new Date('@Model.FechaFin.ToString("yyyy-MM-dd")');
        fechaFin.setDate(fechaFin.getDate() + 30);
        document.getElementById('nuevaFechaFin').value = fechaFin.toISOString().split('T')[0];
    </script>
}

