@model Inmobiliaria.Models.Contrato

@{
    ViewData["Title"] = "Terminar Contrato Anticipadamente";
}

<h1>Terminar Contrato Anticipadamente</h1>

<h3>¿Estás seguro que deseas terminar este contrato antes de su fecha de fin?</h3>
<hr />

<div class="row">
    <div class="col-md-8">
        <table class="table table-bordered">
            <tr>
                <th>ID</th>
                <td>@Model.Id</td>
            </tr>
            <tr>
                <th>Inmueble</th>
                <td>@Model.Inmueble?.Direccion</td>
            </tr>
            <tr>
                <th>Inquilino</th>
                <td>@Model.Inquilino?.Nombre @Model.Inquilino?.Apellido</td>
            </tr>
            <tr>
                <th>Fecha de Inicio</th>
                <td>@Model.FechaInicio.ToShortDateString()</td>
            </tr>
            <tr>
                <th>Fecha de Fin Original</th>
                <td>@Model.FechaFin.ToShortDateString()</td>
            </tr>
            <tr>
                <th>Monto Mensual</th>
                <td>@Model.MontoMensual.ToString("C")</td>
            </tr>
        </table>

        <form asp-action="Terminar" method="post">
            <input type="hidden" asp-for="Id" />
            
            <div class="form-group">
                <label for="fechaTerminacion" class="form-label">Fecha de Terminación:</label>
                <input type="date" name="fechaTerminacion" id="fechaTerminacion" class="form-control" required />
                <small class="form-text text-muted">Debe ser posterior a hoy y anterior a la fecha de fin original (@Model.FechaFin.ToShortDateString())</small>
            </div>

            <div class="form-group">
                <label for="multa" class="form-label">Multa (opcional):</label>
                <input type="number" name="multa" id="multa" class="form-control" step="0.01" min="0" />
                <small class="form-text text-muted">Monto de multa por terminación anticipada</small>
            </div>

            <div class="form-group">
                <label for="motivo" class="form-label">Motivo (opcional):</label>
                <textarea name="motivo" id="motivo" class="form-control" rows="3" placeholder="Motivo de la terminación anticipada..."></textarea>
            </div>

            <div class="alert alert-warning">
                <i class="fa-solid fa-exclamation-triangle"></i>
                <strong>Advertencia:</strong> Esta acción terminará el contrato antes de su fecha de fin original. 
                El inmueble quedará disponible para nuevos contratos.
            </div>

            <div class="form-group">
                <button type="submit" class="btn btn-warning">
                    <i class="fa-solid fa-calendar-times"></i> Confirmar Terminación
                </button>
                <a class="btn btn-secondary" asp-action="Index">
                    <i class="fa-solid fa-arrow-left"></i> Cancelar
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        // Establecer fecha mínima (mañana)
        var tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        document.getElementById('fechaTerminacion').min = tomorrow.toISOString().split('T')[0];
        
        // Establecer fecha máxima (fecha de fin original)
        document.getElementById('fechaTerminacion').max = '@Model.FechaFin.ToString("yyyy-MM-dd")';
        
        // Establecer fecha por defecto (mañana)
        document.getElementById('fechaTerminacion').value = tomorrow.toISOString().split('T')[0];
    </script>
}

